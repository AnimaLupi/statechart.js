!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.statechart=e():t.statechart=e()}(this,function(){return function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var r={};return e.m=t,e.c=r,e.p="",e(0)}([function(t,e,r){t.exports={State:r(2),RoutableState:r(5),router:r(1)}},function(t,e,r){!function(){"use strict";function e(t){var e=t.replace(l,"\\$&").replace(p,"([^/]*)").replace(f,"(.*?)");return new RegExp("^"+e+"$")}function n(t){var e,r,n=t.match(d)||[];for(e=0,r=n.length;r>e;e++)n[e]=n[e].slice(1);return n}function o(t,e){var r,n,o=t.regex.exec(e).slice(1),i={};for(r=0,n=t.names.length;n>r;r++)i[t.names[r]]=o[r];return i}function i(t,e){return t.pattern.replace(d,function(t,r){return e[r]})}function s(t,e){var r,n={};for(r in e)-1===t.names.indexOf(r)&&(n[r]=e[r]);return n}function a(t,e){return Object.keys(e).length?t+"?"+h.stringify(e):t}function u(){this.__routes__=[],this.__route__=null,this.__params__={}}r(6);var h=r(10),c=r(7),_=r(3),l=/[\-{}\[\]+?.,\\\^$|#\s]/g,p=/:(\w+)/g,f=/\*(\w+)/g,d=/[:*](\w+)/g;u.prototype.urlFor=function(t,e){var r=i(t,e),n=s(t,e);return a(r,n)},u.prototype.define=function(t,r){var o={pattern:t,regex:e(t),names:n(t),callback:r};return this.__routes__.push(o),o},u.prototype.unknown=function(t){return this.__unknown__=t,this},u.prototype.start=function(t){var e=this;return this.__started__||(this.__window__=t&&t.window||("undefined"!=typeof window?window:{}),this.__location__=this.__window__.history.location||this.__window__.location,this.__history__=this.__window__.history,this._onPopState=function(){var t=e.__location__;e._handleLocationChange(t.pathname,h.parse(t.search.replace(/^\?/,"")))},this._onClick=function(t){e._handleClick(t)},this.__window__.addEventListener("popstate",this._onPopState),this.__window__.addEventListener("click",this._onClick),this._onPopState(),this.__started__=!0),this},u.prototype.stop=function(){return this.__started__&&(this.__window__.removeEventListener("popstate",this._onPopState),this.__window__.removeEventListener("click",this._onClick),delete this._onPopState,this.__started__=!1),this},u.prototype.reset=function(){return this._timer&&clearTimeout(this._timer),this.stop(),u.call(this),this},u.prototype.route=function(t){return arguments.length?(this.__route__=t,this._flush(),t):this.__route__},u.prototype.params=function(t,e){return arguments.length?(e?this.__params__=t||{}:_.assign(this.__params__,t),this._flush(),this.__params__):this.__params__},u.prototype._recognize=function(t){var e,r,n;for(r=0,n=this.__routes__.length;n>r;r++)if(e=this.__routes__[r],e.regex.exec(t))return e;return null},u.prototype._handleLocationChange=function(t,e){var r,n,i=this.route(),s=this.params();return r=_.assign({},e),t="function"==typeof this.preprocess?this.preprocess(t):t,(n=this._recognize(t))?(r=_.assign(r,o(n,t)),void(this.__route__===n&&c(this.__params__,r)||(this.__route__=n,this.__params__=r,n.callback(r)===!1&&(this.__route__=i,this.__params__=s,this.flush())))):void(this.__unknown__&&this.__unknown__(t))},u.prototype._handleClick=function(t){var e,r,n,o=t.target;if(!t.ctrlKey&&!t.metaKey&&2!==t.which){for(;o&&"a"!==String(o.nodeName).toLowerCase();)o=o.parentNode;o&&(e=o.pathname,r=o.host.replace(/:\d+$/,""),n=this.__location__.host.replace(/:\d+$/,""),e.match(/^\//)||(e="/"+e),r===n&&this._recognize(e)&&(t.preventDefault(),this._handleLocationChange(e,h.parse(o.search.replace(/^\?/,"")))))}},u.prototype._flush=function(){var t=this;return this._timer||(this._timer=setTimeout(function(){t.flush()})),this},u.prototype.flush=function(){if(!this.__started__||!this.__route__)return this;var t=this.__location__.pathname,e=i(this.__route__,this.__params__),r=s(this.__route__,this.__params__),n=a(e,r),o=this.replace||t===e;return this.__history__[o?"replaceState":"pushState"]({},null,n),clearTimeout(this._timer),delete this._timer,delete this.replace,this},t.exports=new u}()},function(t){!function(){"use strict";function e(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(t){var n,o,i=[];for(n=0,o=t.length;o>n;n++)e(t[n])?i=i.concat(r(t[n])):i.push(t[n]);return i}function n(t){var e,r,n,o={},i=[];for(r=0,n=t.length;n>r;r++)t[r]&&(e=t[r].path(),o[e]||(i.push(t[r]),o[e]=!0));return i}function o(){return this.__cache__._path=this.__cache__._path||(this.superstate?o.call(this.superstate).concat(this):[this])}function i(){var t,e,r=[];if(!this.__isCurrent__)return[];if(0===this.substates.length)return[this];for(t=0,e=this.substates.length;e>t;t++)this.substates[t].__isCurrent__&&(r=r.concat(i.call(this.substates[t])));return r}function s(t){var e,r,n,i=o.call(this),s=o.call(t);for(e=0,r=i.length<s.length?i.length:s.length;r>e&&i[e]===s[e];e++)n=i[e];if(!n)throw new Error("State#findPivot: states "+this+" and "+t+" do not belong to the same statechart");return n}function a(t,e,r){this.__transitions__.push({pivot:t,states:e,opts:r})}function u(){var t,e,r=this.__transitions__;if(r&&0!==r.length){for(t=0,e=r.length;e>t;t++)p.call(r[t].pivot,r[t].states,r[t].opts);this.__transitions__=[]}}function h(t){var e,r;for(e=0,r=this.enters.length;r>e;e++)this.enters[e].call(this,t)}function c(t){var e,r;for(e=0,r=this.exits.length;r>e;e++)this.exits[e].call(this,t)}function _(t,e){var i,s,a,u,c,l,f=o.call(this).length,d=[];for(c=0,l=this.substates.length;l>c;c++)if(this.substates[c].__isCurrent__){a=this.substates[c];break}for(c=0,l=t.length;l>c;c++)d.push(o.call(t[c])[f]);if(n(d).length>1)throw new Error("State#enterClustered: attempted to enter multiple substates of "+this+": "+d.join(", "));if(!(u=d[0])&&this.substates.length>0){if(this.__condition__&&(s=this.__condition__.call(this,e.context))){for(s=r([s]),t=[],c=0,l=s.length;l>c;c++){if(!(i=this.resolve(s[c])))throw new Error("State#enterClustered: could not resolve path '"+s[c]+"' returned by condition function from "+this);t.push(i)}return _.call(this,t,e)}this.history&&(u=this.__previous__),u||(u=this.substates[0])}return a&&a!==u&&g.call(a,e),(!this.__isCurrent__||e.force)&&(b.call(this,"State: [ENTER]  : "+this.path()+(this.__isCurrent__?" (forced)":"")),this.__isCurrent__=!0,h.call(this,e.context)),u&&p.call(u,t,e),this}function l(t,e){var r,n,o,i,a,u;for((!this.__isCurrent__||e.force)&&(b.call(this,"State: [ENTER]  : "+this.path()+(this.__isCurrent__?" (forced)":"")),this.__isCurrent__=!0,h.call(this,e.context)),o=0,a=this.substates.length;a>o;o++){for(r=this.substates[o],n=[],i=0,u=t.length;u>i;i++)s.call(r,t[i])===r&&n.push(t[i]);p.call(r,n,e)}return this}function p(t,e){return this.concurrent?l.call(this,t,e):_.call(this,t,e)}function f(t){var e,r,n;for(r=0,n=this.substates.length;n>r;r++)if(this.substates[r].__isCurrent__){e=this.substates[r];break}return this.history&&(this.__previous__=e),e&&g.call(e,t),c.call(this,t.context),this.__isCurrent__=!1,b.call(this,"State: [EXIT]   : "+this.path()),this}function d(t){var e,r,n=this.root();for(e=0,r=this.substates.length;r>e;e++)g.call(this.substates[e],t);return c.call(this,t.context),this.__isCurrent__=!1,this!==n&&b.call(this,"State: [EXIT]   : "+this.path()),this}function g(t){return this.concurrent?d.call(this,t):f.call(this,t)}function v(t,e){var r,n;for(r=0,n=this.substates.length;n>r;r++)if(this.substates[r].__isCurrent__&&v.call(this.substates[r],t,e)===!1)return!1;return this.canExit(t,e.context)}function y(){var t,e,r,n=!1;for(t=0,e=this.substates.length;e>t;t++)if(this.substates[t].__isCurrent__){r=this.substates[t];break}return r&&(n=!!r.send.apply(r,x.call(arguments))),n}function m(){var t,e,r,n=x.call(arguments),o=!0;for(e=0,r=this.substates.length;r>e;e++)t=this.substates[e],o=t.send.apply(t,n)&&o;return o}function b(t){var e=w.logger||console;this.root().trace&&e&&e.info(t)}function w(t,e,r){if("function"==typeof e&&(r=e,e={}),e=e||{},e.concurrent&&e.H)throw new Error("State: history states are not allowed on concurrent states");this.name=t,this.substateMap={},this.substates=[],this.superstate=null,this.enters=[],this.exits=[],this.events={},this.concurrent=!!e.concurrent,this.history=!!e.H,this.deep="*"===e.H,this.__isCurrent__=!1,this.__cache__={},this.__transitions__=[],this.trace=!1,r&&r.call(this)}var x=Array.prototype.slice;w.define=function(){var t,e={},r=null;return 2===arguments.length?(e=arguments[0],r=arguments[1]):1===arguments.length&&("function"==typeof arguments[0]?r=arguments[0]:e=arguments[0]),t=new this("__root__",e,r)},w.prototype.isRoot=function(){return"__root__"===this.name},w.prototype.state=function(t,e,r){var n=t instanceof this.constructor?t:new this.constructor(t,e,r);return this.addSubstate(n),n},w.prototype.enter=function(t){return this.enters.push(t),this},w.prototype.exit=function(t){return this.exits.push(t),this},w.prototype.canExit=function(){return!0},w.prototype.event=function(t,e){return this.events[t]=e,this},w.prototype.C=function(t){if(this.concurrent)throw new Error("State#C: a concurrent state may not have a condition state: "+this);this.__condition__=t},w.prototype.current=function(){var t,e,r=i.call(this),n=[];for(t=0,e=r.length;e>t;t++)n.push(r[t].path());return n},w.prototype.each=function(t){var e,r;for(t(this),e=0,r=this.substates.length;r>e;e++)this.substates[e].each(t);return this},w.prototype.addSubstate=function(t){var e=this.deep,r=this.root().isRoot();return this.substateMap[t.name]=t,this.substates.push(t),t.superstate=this,t.each(function(t){t.__cache__={},e&&(t.history=t.deep=!0),r&&t.didAttach()}),this},w.prototype.didAttach=function(){},w.prototype.isAttached=function(){return this.root().isRoot()},w.prototype.root=function(){return this.__cache__.root=this.__cache__.root||(this.superstate?this.superstate.root():this)},w.prototype.path=function(){var t,e,r=o.call(this),n=[];for(t=1,e=r.length;e>t;t++)n.push(r[t].name);return"/"+n.join("/")},w.prototype["goto"]=function(){var t,e,o,i,h=this.root(),c=r(x.call(arguments)),_="object"==typeof c[c.length-1]?c.pop():{},l=[],p=[];for(o=0,i=c.length;i>o;o++){if(!(t=this.resolve(c[o])))throw new Error("State#goto: could not resolve path "+c[o]+" from "+this);l.push(t)}for(o=0,i=l.length;i>o;o++)p.push(s.call(this,l[o]));if(n(p).length>1)throw new Error("State#goto: multiple pivot states found between state "+this+" and paths "+c.join(", "));if(e=p[0]||this,v.call(e,l,_)===!1)return b.call(this,"State: [GOTO]   : "+this+" can not exit]"),!1;if(b.call(this,"State: [GOTO]   : "+this+" -> ["+l.join(", ")+"]"),!this.__isCurrent__&&this.superstate)throw new Error("State#goto: state "+this+" is not current");if(e.concurrent&&e!==this)throw new Error("State#goto: one or more of the given paths are not reachable from state "+this+": "+c.join(", "));return a.call(h,e,l,_),this.__isSending__||u.call(h),!0},w.prototype.send=function(){var t,e=x.call(arguments),r=this.events;if(!this.__isCurrent__)throw new Error("State#send: attempted to send an event to a state that is not current: "+this);return this===this.root()&&b.call(this,"State: [EVENT]  : "+e[0]),t=this.concurrent?m.apply(this,arguments):y.apply(this,arguments),t||"function"!=typeof r[e[0]]||(this.__isSending__=!0,t=!!r[e[0]].apply(this,e.slice(1)),this.__isSending__=!1),this.superstate||u.call(this),t},w.prototype.reset=function(){g.call(this,{})},w.prototype.isCurrent=function(t){var e=this.resolve(t);return!(!e||!e.__isCurrent__)},w.prototype.resolve=function(t){var e,r;if(!t)return null;switch(t="string"==typeof t?t.split("/"):t,e=t.shift()){case"":r=this.root();break;case".":r=this;break;case"..":r=this.superstate;break;default:r=this.substateMap[e]}return r?0===t.length?r:r.resolve(t):null},w.prototype.toString=function(){return"State("+this.path()+")"},t.exports=w}()},function(t,e){!function(){"use strict";var t=Array.prototype.slice;e.assign=function(e){var r,n,o,i=t.call(arguments).slice(1);for(r=0,n=i.length;n>r;r++)for(o in i[r])void 0===i[r][o]||null===i[r][o]||i[r][o]===!1?delete e[o]:e[o]=i[r][o];return e},e.pick=function(t,e){return e.reduce(function(e,r){return e[r]=t[r],e},{})}}()},function(t){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e,r){!function(){"use strict";function e(){n.apply(this,arguments)}var n=r(2),o=r(1),i=r(3);i.assign(e,n),e.prototype=Object.create(n.prototype),e.prototype.constructor=e,e.prototype.route=function(t,e,r){var o;if(2!==arguments.length||"string"==typeof e||e instanceof n||(r=e,e=null),o=e||".",o="string"==typeof o?this.resolve(o):o,!o)throw new Error("RoutableState#route: invalid state: "+String(e));return o._route(t,r||{})},e.prototype._route=function(t,e){if(this.__route__)throw new Error("RoutableState#route: a route has already been defined on "+this);return this.isAttached()?this._registerRoute(t,e):this.__pendingRoute__={pattern:t,opts:e},this},e.prototype._registerRoute=function(t,e){var r=this;this.__route__=o.define(t,function(t){r.root()["goto"](r.path(),{force:!0,context:t})}),e["default"]&&o.define("/",function(t){return o.replace=!0,r.root()["goto"](r.path(),{force:!0,context:t})}),this.enter(function(t){o.route(this.__route__),o.params(i.pick(t||{},this.__route__.names))}),this.exit(function(t){var e,r,n={},i=this.__route__.names;for(t=t||{},e=0,r=i.length;r>e;e++)i[e]in t||(n[i[e]]=void 0);o.params(n)})},e.prototype.didAttach=function(){return this.__pendingRoute__&&(this._registerRoute(this.__pendingRoute__.pattern,this.__pendingRoute__.opts),delete this.__pendingRoute__),this},e.prototype.start=function(t){return o.start(t),this},e.prototype.stop=function(){return o.stop(),this},e.prototype.params=function(){return o.params.apply(o,arguments)},e.prototype.unknown=function(t){return o.unknown(t),this},e.prototype.urlFor=function(t,e){var r=this.resolve(t);if(!r)throw new Error("RoutableState#urlFor: could not resolve path `"+t+"`");if(!r.__route__)throw new Error("RoutableState#urlFor: state `"+t+"` does not have a route defined");return o.urlFor(r.__route__,e||{})},t.exports=e}()},function(t,e,r){/*!
	 * History API JavaScript Library v4.2.0
	 *
	 * Support: IE8+, FF3+, Opera 9+, Safari, Chrome and other
	 *
	 * Copyright 2011-2014, Dmitrii Pakhtinov ( spb.piksel@gmail.com )
	 *
	 * http://spb-piksel.ru/
	 *
	 * Dual licensed under the MIT and GPL licenses:
	 *   http://www.opensource.org/licenses/mit-license.php
	 *   http://www.gnu.org/licenses/gpl.html
	 *
	 * Update: 2014-11-06 21:35
	 */
!function(t){r(4).amd?r(4)("object"!=typeof document||"loading"!==document.readyState?[]:"html5-history-api",t):t()}(function(){function t(){}function e(t,r,n){var o=/(?:(\w+\:))?(?:\/\/(?:[^@]*@)?([^\/:\?#]+)(?::([0-9]+))?)?([^\?#]*)(?:(\?[^#]+)|\?)?(?:(#.*))?/;if(null==t||""===t||r)t=r?t:x.href,(!O||n)&&(t=t.replace(/^[^#]*/,"")||"#",t=x.protocol.replace(/:.*$|$/,":")+"//"+x.host+F.basepath+t.replace(new RegExp("^#[/]?(?:"+F.type+")?"),""));else{var i=e(),s=y.getElementsByTagName("base")[0];!n&&s&&s.getAttribute("href")&&(s.href=s.href,i=e(s.href,null,!0));var a=i._pathname,u=i._protocol;t=""+t,t=/^(?:\w+\:)?\/\//.test(t)?0===t.indexOf("/")?u+t:t:u+"//"+i._host+(0===t.indexOf("/")?t:0===t.indexOf("?")?a+t:0===t.indexOf("#")?a+i._search+t:a.replace(/[^\/]+$/g,"")+t)}G.href=t;var h=o.exec(G.href),c=h[2]+(h[3]?":"+h[3]:""),_=h[4]||"/",l=h[5]||"",p="#"===h[6]?"":h[6]||"",f=_+l+p,d=_.replace(new RegExp("^"+F.basepath,"i"),F.type)+l;return{_href:h[1]+"//"+c+f,_protocol:h[1],_host:c,_hostname:h[2],_port:h[3]||"",_pathname:_,_search:l,_hash:p,_relative:f,_nohash:d,_special:d+p}}function r(){var t;try{t=v.sessionStorage,t.setItem(B+"t","1"),t.removeItem(B+"t")}catch(e){t={getItem:function(t){var e=y.cookie.split(t+"=");return e.length>1&&e.pop().split(";").shift()||"null"},setItem:function(t){var e={};(e[x.href]=S.state)&&(y.cookie=t+"="+w.stringify(e))}}}try{M=w.parse(t.getItem(B))||{}}catch(e){M={}}$(P+"unload",function(){t.setItem(B,w.stringify(M))},!1)}function n(e,r,n,o){var i=0;n||(n={set:t},i=1);var s=!n.set,a=!n.get,u={configurable:!0,set:function(){s=1},get:function(){a=1}};try{j(e,r,u),e[r]=e[r],j(e,r,n)}catch(h){}if(!(s&&a||(e.__defineGetter__&&(e.__defineGetter__(r,u.get),e.__defineSetter__(r,u.set),e[r]=e[r],n.get&&e.__defineGetter__(r,n.get),n.set&&e.__defineSetter__(r,n.set)),s&&a))){if(i)return!1;if(e===v){try{var c=e[r];e[r]=null}catch(h){}if("execScript"in v)v.execScript("Public "+r,"VBScript"),v.execScript("var "+r+";","JavaScript");else try{j(e,r,{value:t})}catch(h){"onpopstate"===r&&($("popstate",n=function(){N("popstate",n,!1);var t=e.onpopstate;e.onpopstate=null,setTimeout(function(){e.onpopstate=t},1)},!1),z=0)}e[r]=c}else try{try{var _=b.create(e);j(b.getPrototypeOf(_)===e?_:e,r,n);for(var l in e)"function"==typeof e[l]&&(_[l]=e[l].bind(e));try{o.call(_,_,e)}catch(h){}e=_}catch(h){j(e.constructor.prototype,r,n)}}catch(h){return!1}}return e}function o(t,e,r){return r=r||{},t=t===Y?x:t,r.set=r.set||function(r){t[e]=r},r.get=r.get||function(){return t[e]},r}function i(t,e,r){t in J?J[t].push(e):arguments.length>3?$(t,e,r,arguments[3]):$(t,e,r)}function s(t,e,r){var n=J[t];if(n){for(var o=n.length;o--;)if(n[o]===e){n.splice(o,1);break}}else N(t,e,r)}function a(e,r){var o=(""+("string"==typeof e?e:e.type)).replace(/^on/,""),i=J[o];if(i){if(r="string"==typeof e?r:e,null==r.target)for(var s=["target","currentTarget","srcElement","type"];e=s.pop();)r=n(r,e,{get:"type"===e?function(){return o}:function(){return v}});z&&(("popstate"===o?v.onpopstate:v.onhashchange)||t).call(v,r);for(var a=0,u=i.length;u>a;a++)i[a].call(v,r);return!0}return U(e,r)}function u(){var t=y.createEvent?y.createEvent("Event"):y.createEventObject();t.initEvent?t.initEvent("popstate",!1,!1):t.type="popstate",t.state=S.state,a(t)}function h(){D&&(D=!1,u())}function c(t,r,n,o){if(O)K=x.href;else{0===H&&(H=2);var i=e(r,2===H&&-1!==(""+r).indexOf("#"));i._relative!==e()._relative&&(K=o,n?x.replace("#"+i._special):x.hash=i._special)}!k&&t&&(M[x.href]=t),D=!1}function _(t){var r=K;if(K=x.href,r){V!==x.href&&u(),t=t||v.event;var n=e(r,!0),o=e();t.oldURL||(t.oldURL=n._href,t.newURL=o._href),n._hash!==o._hash&&a(t)}}function l(t){setTimeout(function(){$("popstate",function(t){V=x.href,k||(t=n(t,"state",{get:function(){return S.state}})),a(t)},!1)},0),!O&&t!==!0&&"location"in S&&(d(A.hash),h())}function p(t){for(;t;){if("A"===t.nodeName)return t;t=t.parentNode}}function f(t){var r=t||v.event,n=p(r.target||r.srcElement),o="defaultPrevented"in r?r.defaultPrevented:r.returnValue===!1;if(n&&"A"===n.nodeName&&!o){var i=e(),s=e(n.getAttribute("href",2)),a=i._href.split("#").shift()===s._href.split("#").shift();a&&s._hash&&(i._hash!==s._hash&&(A.hash=s._hash),d(s._hash),r.preventDefault?r.preventDefault():r.returnValue=!1)}}function d(t){var e=y.getElementById(t=(t||"").replace(/^#/,""));if(e&&e.id===t&&"A"===e.nodeName){var r=e.getBoundingClientRect();v.scrollTo(m.scrollLeft||0,r.top+(m.scrollTop||0)-(m.clientTop||0))}}function g(){var t=y.getElementsByTagName("script"),i=(t[t.length-1]||{}).src||"",s=-1!==i.indexOf("?")?i.split("?").pop():"";s.replace(/(\w+)(?:=([^&]*))?/g,function(t,e,r){F[e]=(r||"").replace(/^(0|false)$/,"")}),$(P+"hashchange",_,!1);var a=[Y,A,q,v,W,S];k&&delete W.state;for(var u=0;u<a.length;u+=2)for(var h in a[u])if(a[u].hasOwnProperty(h))if("function"==typeof a[u][h])a[u+1][h]=a[u][h];else{var c=o(a[u],h,a[u][h]);if(!n(a[u+1],h,c,function(t,e){e===S&&(v.history=S=a[u+1]=t)}))return N(P+"hashchange",_,!1),!1;a[u+1]===v&&(J[h]=J[h.substr(2)]=[])}return S.setup(),F.redirect&&S.redirect(),F.init&&(H=1),!k&&w&&r(),O||y[T](P+"click",f,!1),"complete"===y.readyState?l(!0):(O||e()._relative===F.basepath||(D=!0),$(P+"load",l,!1)),!0}var v=("object"==typeof window?window:this)||{};if(!v.history||"emulate"in v.history)return v.history;var y=v.document,m=y.documentElement,b=v.Object,w=v.JSON,x=v.location,E=v.history,S=E,C=E.pushState,R=E.replaceState,O=!!C,k="state"in E,j=b.defineProperty,A=n({},"t")?{}:y.createElement("a"),P="",T=v.addEventListener?"addEventListener":(P="on")&&"attachEvent",I=v.removeEventListener?"removeEventListener":"detachEvent",L=v.dispatchEvent?"dispatchEvent":"fireEvent",$=v[T],N=v[I],U=v[L],F={basepath:"/",redirect:0,type:"/",init:0},B="__historyAPI__",G=y.createElement("a"),K=x.href,V="",z=1,D=!1,H=0,M={},J={},X=y.title,q={onhashchange:null,onpopstate:null},Q=function(t,e){var r=v.history!==E;r&&(v.history=E),t.apply(E,e),r&&(v.history=S)},W={setup:function(t,e,r){F.basepath=(""+(null==t?F.basepath:t)).replace(/(?:^|\/)[^\/]*$/,"/"),F.type=null==e?F.type:e,F.redirect=null==r?F.redirect:!!r},redirect:function(t,r){if(S.setup(r,t),r=F.basepath,v.top==v.self){var n=e(null,!1,!0)._relative,o=x.pathname+x.search;O?(o=o.replace(/([^\/])$/,"$1/"),n!=r&&new RegExp("^"+r+"$","i").test(o)&&x.replace(n)):o!=r&&(o=o.replace(/([^\/])\?/,"$1/?"),new RegExp("^"+r,"i").test(o)&&x.replace(r+"#"+o.replace(new RegExp("^"+r,"i"),F.type)+x.hash))}},pushState:function(t,e,r){var n=y.title;null!=X&&(y.title=X),C&&Q(C,arguments),c(t,r),y.title=n,X=e},replaceState:function(t,e,r){var n=y.title;null!=X&&(y.title=X),delete M[x.href],R&&Q(R,arguments),c(t,r,!0),y.title=n,X=e},location:{set:function(t){0===H&&(H=1),v.location=t},get:function(){return 0===H&&(H=1),O?x:A}},state:{get:function(){return M[x.href]||null}}},Y={assign:function(t){0===(""+t).indexOf("#")?c(null,t):x.assign(t)},reload:function(){x.reload()},replace:function(t){0===(""+t).indexOf("#")?c(null,t,!0):x.replace(t)},toString:function(){return this.href},href:{get:function(){return e()._href}},protocol:null,host:null,hostname:null,port:null,pathname:{get:function(){return e()._pathname}},search:{get:function(){return e()._search}},hash:{set:function(t){c(null,(""+t).replace(/^(#|)/,"#"),!1,K)},get:function(){return e()._hash}}};return g()?(S.emulate=!O,v[T]=i,v[I]=s,v[L]=a,S):void 0})},function(t){function e(t,e,i){var s=Array.isArray(t),a=Array.isArray(e);if(s!==a)return!1;var u=typeof t,h=typeof e;return u!==h?!1:o(u)?i?i(t,e):t===e:s?r(t,e,i):n(t,e,i)}function r(t,e,r){var n=t.length;if(n!==e.length)return!1;if(r){for(var o=0;n>o;o++)if(!r(t[o],e[o]))return!1}else for(var o=0;n>o;o++)if(t[o]!==e[o])return!1;return!0}function n(t,e,r){var n=0,o=0;if(r)for(var i in t){if(t.hasOwnProperty(i)&&!r(t[i],e[i]))return!1;n++}else for(var i in t){if(t.hasOwnProperty(i)&&t[i]!==e[i])return!1;n++}for(var i in e)e.hasOwnProperty(i)&&o++;return n===o}function o(t){return"function"!==t&&"object"!==t}t.exports=e},function(t){"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,n,o,i){n=n||"&",o=o||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(n);var u=1e3;i&&"number"==typeof i.maxKeys&&(u=i.maxKeys);var h=t.length;u>0&&h>u&&(h=u);for(var c=0;h>c;++c){var _,l,p,f,d=t[c].replace(a,"%20"),g=d.indexOf(o);g>=0?(_=d.substr(0,g),l=d.substr(g+1)):(_=d,l=""),p=decodeURIComponent(_),f=decodeURIComponent(l),e(s,p)?r(s[p])?s[p].push(f):s[p]=[s[p],f]:s[p]=f}return s};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t){"use strict";function e(t,e){if(t.map)return t.map(e);for(var r=[],n=0;n<t.length;n++)r.push(e(t[n],n));return r}var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,i,s,a){return i=i||"&",s=s||"=",null===t&&(t=void 0),"object"==typeof t?e(o(t),function(o){var a=encodeURIComponent(r(o))+s;return n(t[o])?e(t[o],function(t){return a+encodeURIComponent(r(t))}).join(i):a+encodeURIComponent(r(t[o]))}).join(i):a?encodeURIComponent(r(a))+s+encodeURIComponent(r(t)):""};var n=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},o=Object.keys||function(t){var e=[];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}},function(t,e,r){"use strict";e.decode=e.parse=r(8),e.encode=e.stringify=r(9)}])});