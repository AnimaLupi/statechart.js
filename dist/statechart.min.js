this.statechart=function(t){function s(r){if(e[r])return e[r].exports;var n=e[r]={exports:{},id:r,loaded:!1};return t[r].call(n.exports,n,n.exports,s),n.loaded=!0,n.exports}var e={};return s.m=t,s.c=e,s.p="",s(0)}([function(t,s,e){s.State=e(1)},function(t){!function(){"use strict";function s(t){return"[object Array]"===Object.prototype.toString.call(t)}function e(t){var r,n,i=[];for(r=0,n=t.length;n>r;r++)s(t[r])?i=i.concat(e(t[r])):i.push(t[r]);return i}function r(t){var s,e,r,n={},i=[];for(e=0,r=t.length;r>e;e++)t[e]&&(s=t[e].path(),n[s]||(i.push(t[e]),n[s]=!0));return i}function n(){return this.__cache__._path=this.__cache__._path||(this.superstate?n.call(this.superstate).concat(this):[this])}function i(){var t,s,e=[];if(!this.__isCurrent__)return[];if(0===this.substates.length)return[this];for(t=0,s=this.substates.length;s>t;t++)this.substates[t].__isCurrent__&&(e=e.concat(i.call(this.substates[t])));return e}function o(t){var s,e,r,i=n.call(this),o=n.call(t);for(s=0,e=i.length<o.length?i.length:o.length;e>s&&i[s]===o[s];s++)r=i[s];if(!r)throw new Error("State#findPivot: states "+this+" and "+t+" do not belong to the same statechart");return r}function h(t,s,e){this.__transitions__.push({pivot:t,states:s,opts:e})}function a(){var t,s,e=this.__transitions__;if(e&&0!==e.length){for(t=0,s=e.length;s>t;t++)p.call(e[t].pivot,e[t].states,e[t].opts);this.__transitions__=[]}}function u(t){var s,e;for(s=0,e=this.enters.length;e>s;s++)this.enters[s].call(this,t)}function c(t){var s,e;for(s=0,e=this.exits.length;e>s;s++)this.exits[s].call(this,t)}function l(t,s){var i,o,h,a,c,_,f=n.call(this).length,g=[];for(c=0,_=this.substates.length;_>c;c++)if(this.substates[c].__isCurrent__){h=this.substates[c];break}for(c=0,_=t.length;_>c;c++)g.push(n.call(t[c])[f]);if(r(g).length>1)throw new Error("State#enterClustered: attempted to enter multiple substates of "+this+": "+g.join(", "));if(!(a=g[0])&&this.substates.length>0){if(this.__condition__&&(o=this.__condition__.call(this,s.context))){for(o=e([o]),t=[],c=0,_=o.length;_>c;c++){if(!(i=this.resolve(o[c])))throw new Error("State#enterClustered: could not resolve path '"+o[c]+"' returned by condition function from "+this);t.push(i)}return l.call(this,t,s)}this.history&&(a=this.__previous__),a||(a=this.substates[0])}return h&&h!==a&&v.call(h,s),(!this.__isCurrent__||s.force)&&(m.call(this,"State: [ENTER]  : "+this.path()+(this.__isCurrent__?" (forced)":"")),this.__isCurrent__=!0,u.call(this,s.context)),a&&p.call(a,t,s),this}function _(t,s){var e,r,n,i,h,a;for((!this.__isCurrent__||s.force)&&(m.call(this,"State: [ENTER]  : "+this.path()+(this.__isCurrent__?" (forced)":"")),this.__isCurrent__=!0,u.call(this,s.context)),n=0,h=this.substates.length;h>n;n++){for(e=this.substates[n],r=[],i=0,a=t.length;a>i;i++)o.call(e,t[i])===e&&r.push(t[i]);p.call(e,r,s)}return this}function p(t,s){return this.concurrent?_.call(this,t,s):l.call(this,t,s)}function f(t){var s,e,r;for(e=0,r=this.substates.length;r>e;e++)if(this.substates[e].__isCurrent__){s=this.substates[e];break}return this.history&&(this.__previous__=s),s&&v.call(s,t),c.call(this,t.context),this.__isCurrent__=!1,m.call(this,"State: [EXIT]   : "+this.path()),this}function g(t){var s,e,r=this.root();for(s=0,e=this.substates.length;e>s;s++)v.call(this.substates[s],t);return c.call(this,t.context),this.__isCurrent__=!1,this!==r&&m.call(this,"State: [EXIT]   : "+this.path()),this}function v(t){return this.concurrent?g.call(this,t):f.call(this,t)}function b(t,s){var e,r;for(e=0,r=this.substates.length;r>e;e++)if(this.substates[e].__isCurrent__&&b.call(this.substates[e],t,s)===!1)return!1;return this.canExit(t,s.context)}function d(){var t,s,e,r=!1;for(t=0,s=this.substates.length;s>t;t++)if(this.substates[t].__isCurrent__){e=this.substates[t];break}return e&&(r=!!e.send.apply(e,w.call(arguments))),r}function y(){var t,s,e,r=w.call(arguments),n=!0;for(s=0,e=this.substates.length;e>s;s++)t=this.substates[s],n=t.send.apply(t,r)&&n;return n}function m(t){var s=S.logger||console;this.root().trace&&s&&s.info(t)}function S(t,s,e){if("function"==typeof s&&(e=s,s={}),s=s||{},s.concurrent&&s.H)throw new Error("State: history states are not allowed on concurrent states");this.name=t,this.substateMap={},this.substates=[],this.superstate=null,this.enters=[],this.exits=[],this.events={},this.concurrent=!!s.concurrent,this.history=!!s.H,this.deep="*"===s.H,this.__isCurrent__=!1,this.__cache__={},this.__transitions__=[],this.trace=!1,e&&e.call(this)}var w=Array.prototype.slice;S.define=function(){var t,s={},e=null;return 2===arguments.length?(s=arguments[0],e=arguments[1]):1===arguments.length&&("function"==typeof arguments[0]?e=arguments[0]:s=arguments[0]),t=new this("__root__",s,e)},S.prototype.state=function(t,s,e){var r=t instanceof this.constructor?t:new this.constructor(t,s,e);return this.addSubstate(r),r},S.prototype.enter=function(t){return this.enters.push(t),this},S.prototype.exit=function(t){return this.exits.push(t),this},S.prototype.canExit=function(){return!0},S.prototype.event=function(t,s){return this.events[t]=s,this},S.prototype.C=function(t){if(this.concurrent)throw new Error("State#C: a concurrent state may not have a condition state: "+this);this.__condition__=t},S.prototype.current=function(){var t,s,e=i.call(this),r=[];for(t=0,s=e.length;s>t;t++)r.push(e[t].path());return r},S.prototype.each=function(t){var s,e;for(t(this),s=0,e=this.substates.length;e>s;s++)this.substates[s].each(t);return this},S.prototype.addSubstate=function(t){var s=this.deep;return this.substateMap[t.name]=t,this.substates.push(t),t.each(function(t){t.__cache__={},s&&(t.history=t.deep=!0)}),t.superstate=this,this},S.prototype.root=function(){return this.__cache__.root=this.__cache__.root||(this.superstate?this.superstate.root():this)},S.prototype.path=function(){var t,s,e=n.call(this),r=[];for(t=1,s=e.length;s>t;t++)r.push(e[t].name);return"/"+r.join("/")},S.prototype["goto"]=function(){var t,s,n,i,u=this.root(),c=e(w.call(arguments)),l="object"==typeof c[c.length-1]?c.pop():{},_=[],p=[];for(n=0,i=c.length;i>n;n++){if(!(t=this.resolve(c[n])))throw new Error("State#goto: could not resolve path "+c[n]+" from "+this);_.push(t)}for(n=0,i=_.length;i>n;n++)p.push(o.call(this,_[n]));if(r(p).length>1)throw new Error("State#goto: multiple pivot states found between state "+this+" and paths "+c.join(", "));if(s=p[0]||this,b.call(s,_,l)===!1)return m.call(this,"State: [GOTO]   : "+this+" can not exit]"),!1;if(m.call(this,"State: [GOTO]   : "+this+" -> ["+_.join(", ")+"]"),!this.__isCurrent__&&this.superstate)throw new Error("State#goto: state "+this+" is not current");if(s.concurrent&&s!==this)throw new Error("State#goto: one or more of the given paths are not reachable from state "+this+": "+c.join(", "));return h.call(u,s,_,l),this.__isSending__||a.call(u),!0},S.prototype.send=function(){var t,s=w.call(arguments),e=this.events;if(!this.__isCurrent__)throw new Error("State#send: attempted to send an event to a state that is not current: "+this);return this===this.root()&&m.call(this,"State: [EVENT]  : "+s[0]),t=this.concurrent?y.apply(this,arguments):d.apply(this,arguments),t||"function"!=typeof e[s[0]]||(this.__isSending__=!0,t=!!e[s[0]].apply(this,s.slice(1)),this.__isSending__=!1),this.superstate||a.call(this),t},S.prototype.reset=function(){v.call(this,{})},S.prototype.isCurrent=function(t){var s=this.resolve(t);return!(!s||!s.__isCurrent__)},S.prototype.resolve=function(t){var s,e;if(!t)return null;switch(t="string"==typeof t?t.split("/"):t,s=t.shift()){case"":e=this.root();break;case".":e=this;break;case"..":e=this.superstate;break;default:e=this.substateMap[s]}return e?0===t.length?e:e.resolve(t):null},S.prototype.toString=function(){return"State("+this.path()+")"},t.exports=S}()}]);